{% extends 'deals/base.html' %}
{% load i18n %}
{% load humanize %}
{% load static %}

{% block body_id %}_deal-detail{% endblock %}
{% block deals_title %}{% trans 'Deal Detail' %}{% endblock %}
{% block content_class %}mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8{% endblock %}

{% block deals_content %}
  {# Breadcrumb #}
  <nav class="mb-4" aria-label="Breadcrumb">
    <ol class="flex items-center gap-2 text-sm text-gray-500">
      <li>
        <a href="{% url 'deals:dashboard' %}" class="hover:text-gray-700">{% trans 'Deals' %}</a>
      </li>
      <li aria-hidden="true" class="text-gray-400">â€º</li>
      <li class="truncate" title="{{ deal.display_name }}">
        <span class="text-gray-700">{{ deal.display_name }}</span>
      </li>
    </ol>
  </nav>

  {# Minimal SSR header card #}
  <div class="rounded-lg border border-gray-200 bg-white p-6 shadow-sm">
    <div class="flex flex-col gap-2 sm:flex-row sm:items-baseline sm:justify-between">
      <h2 class="text-xl font-semibold text-gray-900">{{ deal.display_name }}</h2>
      {% if deal.sent_to_affinity is not None %}
        <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium {{ deal.sent_to_affinity|yesno:'bg-green-50 text-green-700 ring-1 ring-green-600/20,bg-red-50 text-red-700 ring-1 ring-red-600/20,' }}">
          {% if deal.sent_to_affinity %}{% trans 'Sent to Affinity' %}{% else %}{% trans 'Not Sent to Affinity' %}{% endif %}
        </span>
      {% endif %}
    </div>

    <div class="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
      <div>
        <div class="text-sm font-semibold text-gray-500">{% trans 'Company' %}</div>
        <div class="text-gray-900">
          {% if company %}
            <a href="{% url 'companies:company-detail' company.uuid %}" class="text-blue-600 hover:text-blue-700">{{ company.name }}</a>
          {% else %}
            <span class="text-gray-500">-</span>
          {% endif %}
        </div>
      </div>

      <div>
        <div class="text-sm font-semibold text-gray-500">{% trans 'Website' %}</div>
        <div class="text-gray-900">
          {% if deal.website %}
            <a href="{{ deal.website }}" target="_blank" rel="noopener" class="break-all text-blue-600 hover:text-blue-700">{{ deal.website }}</a>
          {% else %}
            <span class="text-gray-500">-</span>
          {% endif %}
        </div>
      </div>

      <div>
        <div class="text-sm font-semibold text-gray-500">{% trans 'Status' %}</div>
        <div class="text-gray-900">{{ deal.get_status_display|default:'-' }}</div>
      </div>

      <div>
        <div class="text-sm font-semibold text-gray-500">{% trans 'Funding Stage' %}</div>
        <div class="text-gray-900">{{ deal.funding_stage.name|default:'-' }}</div>
      </div>

      <div>
        <div class="text-sm font-semibold text-gray-500">{% trans 'Created' %}</div>
        <div class="text-gray-900">{{ deal.created_at|date:'Y-m-d' }}</div>
      </div>
    </div>
  </div>

  {# React mount point #}
  <div id="deal-detail-root" data-uuid="{{ deal.uuid }}" class="mt-6"></div>
{% endblock %}
